<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>ğŸ¥Š KNOCKOUT â€” Hand Tracking Boxing</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* Back button to return to platform hub */
    #back-to-hub {
      position: fixed;
      top: 15px;
      left: 15px;
      z-index: 300;
      background: rgba(0, 0, 0, .6);
      border: 1px solid rgba(255, 255, 255, .2);
      color: #fff;
      font-size: 14px;
      font-weight: 700;
      padding: 10px 18px;
      border-radius: 10px;
      cursor: pointer;
      letter-spacing: 2px;
      backdrop-filter: blur(8px);
      transition: all .2s;
      display: flex;
      align-items: center;
      gap: 8px
    }

    #back-to-hub:hover {
      background: rgba(255, 70, 0, .4);
      border-color: rgba(255, 100, 50, .5);
      transform: scale(1.05)
    }

    #back-to-hub .back-arrow {
      font-size: 18px
    }

    body.in-game #back-to-hub {
      opacity: 0.3
    }

    body.in-game #back-to-hub:hover {
      opacity: 1
    }
  </style>
</head>

<body>

  <!-- BACK TO HUB -->
  <button id="back-to-hub">
    <span class="back-arrow">â†</span> GAMES
  </button>

  <!-- CAMERA (background) -->
  <div id="camera-container">
    <video id="webcam" autoplay playsinline muted></video>
    <canvas id="hand-overlay"></canvas>
  </div>

  <!-- BOXING RING FLOOR -->
  <div id="ring-floor"></div>
  <div id="ropes"></div>

  <!-- VFX CANVAS -->
  <canvas id="vfx-canvas"></canvas>

  <!-- OPPONENT -->
  <div id="opponent">
    <div id="opp-body-wrap">
      <div id="opp-left-arm" class="opp-arm">
        <div class="opp-glove opp-glove-left">ğŸ¥Š</div>
      </div>
      <div id="opp-torso">
        <div id="opp-head">
          <div id="opp-face">
            <div class="opp-eye left"></div>
            <div class="opp-eye right"></div>
            <div id="opp-mouth"></div>
          </div>
          <div id="opp-headband"></div>
        </div>
        <div id="opp-chest"></div>
        <div id="opp-abs"></div>
      </div>
      <div id="opp-right-arm" class="opp-arm">
        <div class="opp-glove opp-glove-right">ğŸ¥Š</div>
      </div>
    </div>
    <!-- TELEGRAPH INDICATOR -->
    <div id="telegraph" class="hidden">
      <div id="telegraph-icon">âš ï¸</div>
    </div>
  </div>

  <!-- YOUR FISTS -->
  <div id="player-left-fist" class="player-fist">ğŸ¥Š</div>
  <div id="player-right-fist" class="player-fist">ğŸ¥Š</div>

  <!-- GUARD INDICATOR -->
  <div id="guard-indicator" class="hidden">ğŸ›¡ï¸ GUARD</div>

  <!-- HUD -->
  <div id="hud">
    <div id="hud-left">
      <div id="player-name">YOU</div>
      <div id="player-hp-bar">
        <div id="player-hp-fill"></div>
      </div>
      <div id="player-stamina-bar">
        <div id="player-stamina-fill"></div>
      </div>
    </div>
    <div id="hud-center">
      <div id="round-display">ROUND 1</div>
      <div id="round-timer">2:00</div>
      <div id="ko-counter" class="hidden">KO COUNT: <span id="ko-count">0</span></div>
    </div>
    <div id="hud-right">
      <div id="opp-name-display">OPPONENT</div>
      <div id="opp-hp-bar">
        <div id="opp-hp-fill"></div>
      </div>
      <div id="opp-stun-bar" class="hidden">
        <div id="opp-stun-fill"></div>
      </div>
    </div>
  </div>

  <!-- SCORE -->
  <div id="score-display">
    <span id="player-score">0</span> â€” <span id="opp-score">0</span>
  </div>

  <!-- ACTION STATE -->
  <div id="action-state"></div>

  <!-- PALM CURSOR (hover-to-select) -->
  <div id="palm-cursor">
    <div class="cursor-ring"></div>
    <div class="cursor-fill"></div>
    <div class="cursor-icon">ğŸ–ï¸</div>
  </div>

  <!-- START SCREEN -->
  <div id="start-screen">
    <div id="start-content">
      <div id="game-title">ğŸ¥Š KNOCKOUT ğŸ¥Š</div>
      <div id="game-subtitle">Real Hand Tracking Boxing</div>
      <div id="start-instructions">
        <p>ğŸ–ï¸ <strong>Show your palm</strong> over the button to start</p>
        <p>ğŸ‘Š <strong>Punch forward</strong> â€” Thrust your fist to attack</p>
        <p>ğŸ›¡ï¸ <strong>Guard</strong> â€” Hold both fists up near your face</p>
        <p>â¬…ï¸â¡ï¸ <strong>Dodge</strong> â€” Move your body left or right</p>
        <p>â¬†ï¸ <strong>Uppercut</strong> â€” Punch upward for big damage</p>
        <p>ğŸ”„ <strong>Hook</strong> â€” Swing from the side</p>
      </div>
      <button id="start-btn" disabled>â³ Loading Camera...</button>
      <div id="camera-status">ğŸ“· Initializing hand tracking...</div>
    </div>
  </div>

  <!-- ROUND SCREEN -->
  <div id="round-screen" class="hidden">
    <div id="round-screen-text">ROUND 1</div>
    <div id="round-screen-sub">FIGHT!</div>
  </div>

  <!-- GAME OVER -->
  <div id="gameover-screen" class="hidden">
    <div id="go-content">
      <div id="go-title">KNOCKOUT!</div>
      <div id="go-result"></div>
      <div id="go-stats"></div>
      <button id="restart-btn">ğŸ¥Š FIGHT AGAIN</button>
    </div>
  </div>

  <!-- POPUP CONTAINER -->
  <div id="popup-container"></div>

  <!-- NEW MediaPipe Tasks Vision API (faster, synchronous detection) -->
  <script type="module">
    import { FilesetResolver, HandLandmarker } from
      'https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/vision_bundle.mjs';
    window.FilesetResolver = FilesetResolver;
    window.HandLandmarker = HandLandmarker;
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="../../hand-tracker.js"></script>
  <script src="boxing.js"></script>
  <script src="opponent.js"></script>
  <script src="sound.js"></script>
  <script src="vfx.js"></script>
  <script src="game.js"></script>
  <script src="app.js"></script>

  <script>
    // Back to hub button
    document.getElementById('back-to-hub').addEventListener('click', () => {
      window.location.href = '../../index.html';
    });
  </script>
</body>

</html>